#!/bin/bash

name="work"
hostname=`hostname`

if [[ -n $TMUX ]];then
    echo "don't use tmux in tmux."
    exit
fi
res=`tmux ls|grep -E "^work"`
if [[ ${res} != "" ]];then
    tmux attach-session -t $name
    exit
fi

normal(){
    cd ~
    tmux new-session -d -s $name -n 0&&
    tmux new-window -t $name:1 -n 1
    tmux new-window -t "$name:2" -n archcn
    tmux split-window -h -p 50
    tmux new-window -t "$name:99"
    tmux split-window -h
    tmux select-pane -L
    tmux split-window -v -p 60
    tmux send-keys -t work:archcn.0 cd\ ~/git/archlinuxcn Enter
    tmux send-keys -t work:archcn.1 cd\ ~/git/archlinuxcn Enter
    tmux send-keys -t work:99.0 !gost Enter
    tmux send-keys -t work:99.1 cd\ ~/Desktop Enter
    tmux send-keys -t work:99.2 ncmpcpp Enter
    tmux select-window -t 0
    tmux attach-session -t $name
}

nas(){
    cd ~
    tmux new-session -d -s $name -n 0
    tmux split-window -h -p 50
    tmux split-window -v -p 50
    tmux select-pane -U
    tmux split-window -v
    tmux select-pane -D
    tmux split-window -v
    tmux new-window -t $name:1 -n 1
    tmux new-window -t "$name:2" -n archcn
    tmux split-window -h -p 50
    tmux new-window -t "$name:99"
    tmux split-window -h
    tmux send-keys -t work:0.0 Enter cd\ ~/git/bangumi\;vim\ \*py Enter
    tmux send-keys -t work:0.1 Enter cd\ ~/git/bangumi Enter
    tmux send-keys -t work:0.2 Enter cd\ ~/git/bangumi Enter
    tmux send-keys -t work:0.3 Enter cd\ ~/git/bangumi Enter
    tmux send-keys -t work:0.4 Enter cd\ ~/git/bangumi Enter
    tmux send-keys -t work:archcn.0 cd\ ~/git/archlinuxcn Enter
    tmux send-keys -t work:archcn.1 cd\ ~/git/archlinuxcn Enter
    tmux send-keys -t work:99.0 !gost Enter
    tmux send-keys -t work:99.1 !transmission Enter
    tmux select-window -t 0
    tmux attach-session -t $name
}

buildmatchine(){
    tmux new-session -d -s $name -n archcn
    tmux split-window -h -p 50
    tmux new-window -t $name:1 -n 1
    tmux split-window -h -p 50
    tmux send-keys -t work:archcn.0 Enter cd\ ~/git/archlinuxcn Enter
    tmux send-keys -t work:archcn.1 cd\ ~/git/archlinuxcn Enter
    tmux select-window -t 0
    tmux attach-session -t $name
}

case ${hostname} in
    *build*)
        buildmatchine
        ;;
    *nas*)
        nas
        ;;
    *)
        normal
        ;;
esac

